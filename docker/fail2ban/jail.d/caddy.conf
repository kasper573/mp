# Fail2ban jail configuration for Caddy web server
# This file should be placed in /etc/fail2ban/jail.d/

[DEFAULT]
# Default ban time: 10 minutes
bantime = 600
# Find time window: 5 minutes
findtime = 300
# Maximum retry attempts before ban
maxretry = 5
# Default backend for log monitoring
backend = auto
# Default action - using iptables for blocking
action = iptables[name=%(__name__)s, port="http,https", protocol=tcp]

# General web application protection
[caddy-general]
enabled = true
filter = caddy-general
logpath = /var/log/caddy/access.log
maxretry = 10
findtime = 600
bantime = 3600

# Authentication failure protection
[caddy-auth]
enabled = true
filter = caddy-auth
logpath = /var/log/caddy/access.log
maxretry = 5
findtime = 300
bantime = 1800

# DoS/DDoS protection
[caddy-dos]
enabled = true
filter = caddy-dos
logpath = /var/log/caddy/access.log
maxretry = 50
findtime = 60
bantime = 600