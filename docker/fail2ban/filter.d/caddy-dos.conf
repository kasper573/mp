# Fail2ban filter for DoS/DDoS attacks via Caddy
# Monitors for rapid requests that might indicate DoS attacks in JSON format

[Definition]
# Match rapid successive requests from same IP (caught by rate limiting) in JSON format
failregex = ^.*"remote_ip":"<HOST>".*"status":429.*$
            ^.*"remote_ip":"<HOST>".*"status":429.*"error":".*rate.*limit.*".*$

# Don't ignore anything for DoS detection
ignoreregex =