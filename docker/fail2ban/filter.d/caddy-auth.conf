# Fail2ban filter for authentication failures via Caddy
# Monitors for authentication and authorization failures in JSON format

[Definition]
# Match authentication failures and unauthorized access attempts in JSON format
failregex = ^.*"remote_ip":"<HOST>".*"status":(401|403).*$
            ^.*"remote_ip":"<HOST>".*"request":.*"uri":"[^"]*(login|signin|auth|oauth)[^"]*".*"status":(401|403|422).*$
            ^.*"remote_ip":"<HOST>".*"request":.*"method":"POST".*"uri":"[^"]*(login|signin|auth)[^"]*".*"status":(400|401|403|422).*$

# Ignore successful authentications
ignoreregex = ^.*"remote_ip":"<HOST>".*"request":.*"uri":"[^"]*(login|signin|auth)[^"]*".*"status":(200|302).*$